package telegram;

import org.telegram.telegrambots.api.methods.send.SendMessage;
import org.telegram.telegrambots.api.objects.Update;
import org.telegram.telegrambots.bots.TelegramLongPollingBot;
import org.telegram.telegrambots.exceptions.TelegramApiException;

import alexander.MinhaAssociacao;
import alexander.associacao.*;
import alexander.exececoes.*;

public class Bot extends TelegramLongPollingBot{
	MinhaAssociacao controle = new MinhaAssociacao();
	BotDao botDao = new BotDao();
	
	public String getBotUsername() {
		// TODO Auto-generated method stub
		return null;
	}

	public void imprimirMensagem(String texto,Update update) {
		SendMessage send = new SendMessage();
		send.setText(texto);
		send.setChatId(update.getMessage().getChatId());
		try {
			sendMessage(send);
			System.out.println("Mensagem enviada!");
		} catch (TelegramApiException e) {
			e.getMessage();
		}
	}
	
	public void onUpdateReceived(Update update) {

		
		SendMessage send = new SendMessage();
		send.setChatId(update.getMessage().getChatId());
		String nome = update.getMessage().getFrom().getFirstName();
		System.out.println("Nome: " + update.getMessage().getFrom().getFirstName()+ " - ID: "+ update.getMessage().getChatId() + " || Text: " + update.getMessage().getText());
		BotDao dao = new BotDao();
		
		dao.consultarPagamentos(update.getMessage().getChatId(), update.getMessage().getText(), update);
		
		/*
		String mensagem = "Bem Vindo! Suas opções são:\n1 - Consultar Pagamentos\n2 - Consultar Frequencia";
		imprimirMensagem(mensagem,update);
		String resp = update.getMessage().getText();
		if(resp.equals("1")) {
			imprimirMensagem("Digite o ano desejado!", update);
			String vigencia = update.getMessage().getText();
			dao.consultarPagamentos(update.getMessage().getChatId(), vigencia, update);
		} else if(resp.equals("2")) {
			imprimirMensagem("Você escolheu Consultar Frequencia", update);
			System.out.println("getMessage: " + update.getMessage().getText());
			imprimirMensagem("Vc digitou: " + update.getMessage().getText(), update);
		}
		*/
	}
	
	@Override
	public String getBotToken() {
		// TODO Auto-generated method stub
		return "528994101:AAE656HO54G_kcA_WSPzkTNnZrQPXLpF0Xo";
	}

}
