#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#define T 20

typedef struct{
	char nome[15];
	int tam;
}tApp;

typedef struct{
	tApp info[T];
	int IL,IA,FL,FA;
}LLV;

void inicializarLLV(LLV *L){
	L->IL = 1;
	L->FL = -1; 
	L->IA = 0;
	L->FA = T;
	printf("Tudo OK em inicializarLLV\n\n");
}

void carregar_Arquivos(tApp *p){
	FILE *leitura;
	int i=0;
	
	leitura = fopen("MobileED.txt", "r");
	
	if(leitura == NULL){
		printf("Erro ao abrir o arquivo.\n");
		exit(0);
	}
	else{
		while((fscanf(leitura,"%s %d\n", &p[i].nome,&p[i].tam))!= EOF){
			i++;
		}
	}
	printf("Tudo OK em carregar_Arquivos\n\n");
	fclose(leitura);
}

void organizar(tApp *aux){
	int i,j;
	tApp aux2;
	
	for(i=0;i<T;i++){
		for(j=0;j<T;j++){
			if(aux[i].tam < aux[j].tam && aux[i].tam != 0){
				aux2 = aux[i];
				aux[i] = aux[j];
				aux[j] = aux2;
			}
		}
	}
	printf("Tudo OK em 'organizar'\n\n");
}

void inserirLLV(LLV *L, tApp *old, int indic_orig){
	int i;
	
	if((L->IL == L->IA) && (L->FL == L->FA)){
		printf("Lista Cheia\n");
		return;
	}
	else{
		if(L->IL > L->IA){
			L->IL--;
			L->info[L->IL] = old[indic_orig];
			printf("Tudo OK em InserirLLV INICIO\n\n");
		}
		else{
			for(i=L->FL;i >= novo->IL; i--){
				novo->info[i+1] = novo->info[i];
			}
			novo->FL++;
		}
	}
	
	if((L->IL == L->IA) && (L->FL == L->FA)){
		printf("Lista Cheia\n");
		return;
	}
	else{
		if(L->FL != L->FA){
			
		}
	}
}

int main(){
	int i,n;
	tApp aux[T];
	LLV s;
	
	for(i=0;i<T;i++){
		s.info[i].tam = 0;
		aux[i].tam = 0;
		strcpy(s.info[i].nome,"");
		strcpy(aux[i].nome,""); 
	}
	
	inicializarLLV(&s);
	carregar_Arquivos(&aux[0]);
	organizar(&aux[0]);
	
	for(i=0;i<T;i++){
		if(aux[i].tam != 0){
			printf("%d - %s %d\n", i+1,aux[i].nome,aux[i].tam);
		}
	}
	
	printf("\n");
	
	while(n != 0){
		printf("Digite o numero do App <0-Sair>: ");
		scanf(" %d", &n);
		inserirLLV(&s,&aux,n-1);
	}
	
	for(i=0;i<T;i++){
		if(s.info[i].tam != 0){
			printf("%s %d\n",s.info[i].nome,s.info[i].tam);
		}
	}
			
	printf("\nTudo OK no MAIN\n");
	
	printf("IL: %d\n", s.IL);
	printf("FL: %d\n", s.FL);
	printf("IA: %d\n", s.IA);
	printf("FA: %d\n", s.FA);
	
	return 0;
}
